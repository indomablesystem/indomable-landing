const i18n = {
    es: {
        "nav-problem": "El Problema",
        "nav-success": "Casos de Éxito",
        "nav-how": "Cómo funciona",
        "nav-pricing": "Precios",
        "nav-cta": "Calcula ROI",
        "hero-badge": "REVOLUCIÓN IA 2026",
        "hero-title": "Vende mientras <span class=\"text-gradient\">duermes</span>.",
        "hero-subtitle": "Automatización comercial 24/7 impulsada por IA. Capturamos, filtramos y cerramos tus reuniones sin intervención humana.",
        "hero-cta-start": "Empieza Ahora",
        "hero-cta-process": "Ver Proceso",
        "status-active": "Activo",
        "problem-title": "¿Tu equipo comercial no da abasto?",
        "problem-subtitle": "El costo de la inmediatez es la diferencia entre cerrar una reunión o perder un cliente para siempre.",
        "problem-card1-h": "El 80% se enfría",
        "problem-card1-p": "Si no respondes a un lead en los primeros 5 minutos, la probabilidad de conversión cae drásticamente.",
        "problem-card2-h": "Fuga de Presupuesto",
        "problem-card2-p": "Inviertes miles en Ads para que leads sin filtrar queden olvidados en una hoja de Excel.",
        "problem-card3-h": "Omnipresencia IA",
        "problem-card3-p": "Indomable nunca duerme. Responde instantáneamente y califica leads las 24 horas del día.",
        "success-title": "Empresas que ya escalan con nosotros",
        "process-title": "El Camino a la Autonomía",
        "step1-h": "Estudio de Mercado",
        "step1-p": "Analizamos tu nicho y competencia para encontrar el ángulo de venta más agresivo.",
        "step2-h": "Creación de Contenido Multimedia",
        "step2-p": "Diseñamos contenido multimedia para conseguir clientes.",
        "step3-h": "Campañas de Meta Ads",
        "step3-p": "Configuramos campañas de alta precisión para atraer tráfico cualificado desde el día 1.",
        "step4-h": "Formulario Inteligente",
        "step4-p": "Formularios inteligentes que adaptan sus preguntas según las respuestas del usuario.",
        "step5-h": "Chatbot de Filtrado IA",
        "step5-p": "El chatbot final califica al lead y agenda la reunión directamente en tu calendario.",
        "integrations-title": "Integraciones de Élite",
        "pricing-title": "Inversión con Retorno",
        "price-plan-name": "Plan Indomable",
        "price-ads-info": "+ Inversión en Ads aparte",
        "feat1": "Estudio de Mercado Completo",
        "feat2": "Producción Audiovisual Persuasiva",
        "feat3": "Gestión de Campañas Meta",
        "feat4": "Integración de Embudo de Venta",
        "feat5": "Soporte Premium 24/7",
        "price-cta": "Empezar Ahora",
        "support-badge": "Soporte Premium Activado",
        "ai-disclosure": "Transparencia: Sistema operado íntegramente por Agentes de IA.",
        "modal-title": "Escala tu negocio hoy",
        "form-name": "Nombre",
        "form-company": "Nombre de Empresa",
        "form-whatsapp": "WhatsApp",
        "form-email": "Gmail / Email",
        "form-service": "Servicio / Producto",
        "form-team": "¿Tienes equipo comercial?",
        "form-submit": "Enviar Solicitud",
        "footer-text": "© 2026 Indomable. Todos los derechos reservados.",
        "compare-title": "El fin de la era manual",
        "compare-manual-status": "MÉTODO TRADICIONAL",
        "compare-ai-status": "SISTEMA iNDOMABLE",
        "manual-f1": "Duerme 8 horas al día.",
        "manual-f2": "Pierde el 80% de leads por tardanza.",
        "manual-f3": "Tiene días malos, estrés y fatiga.",
        "manual-f4": "Cuesta miles en nóminas y seguros.",
        "ai-f1": "Vende 24/7 sin descanso.",
        "ai-f2": "Respuesta en < 10 segundos.",
        "ai-f3": "Consistencia perfecta en cada chat.",
        "ai-f4": "Fracción del costo de un sueldo.",
        "stat-leads": "Leads Filtrados hoy",
        "stat-meetings": "Reuniones Agendadas",
        "stat-uptime": "Uptime del Comercial",
        "faq-title": "Preguntas Frecuentes",
        "faq-q1": "¿Es la IA segura para mi marca?",
        "faq-a1": "Absolutamente. Configuramos barandillas éticas y de tono de marca para que la IA nunca diga nada fuera de lugar.",
        "faq-q2": "¿Cuánto tardo en ver resultados?",
        "faq-a2": "Desde el primer día. Una vez lanzamos las campañas y activamos el agente, empezarás a recibir leads calificados de inmediato.",
        "faq-q3": "¿Tengo que saber programar?",
        "faq-a3": "No. Nosotros nos encargamos de toda la configuración técnica y la integración. Tú solo recibes las reuniones en tu calendario.",
    },
    en: {
        "nav-problem": "The Problem",
        "nav-success": "Success Cases",
        "nav-how": "How it works",
        "nav-pricing": "Pricing",
        "nav-cta": "Calculate ROI",
        "hero-badge": "AI REVOLUTION 2026",
        "hero-title": "Sell while you <span class=\"text-gradient\">sleep</span>.",
        "hero-subtitle": "24/7 AI-powered commercial automation. We capture, filter, and close your meetings without human intervention.",
        "hero-cta-start": "Get Started",
        "hero-cta-process": "See Process",
        "status-active": "Active",
        "problem-title": "Is your sales team overwhelmed?",
        "problem-subtitle": "The cost of immediacy is the difference between closing a meeting or losing a client forever.",
        "problem-card1-h": "80% go cold",
        "problem-card1-p": "If you don't respond to a lead within the first 5 minutes, conversion probability drops drastically.",
        "problem-card2-h": "Budget Leak",
        "problem-card2-p": "You invest thousands in Ads only for unfiltered leads to be forgotten in an Excel sheet.",
        "problem-card3-h": "AI Omnipresence",
        "problem-card3-p": "Indomable never sleeps. Responds instantly and qualifies leads 24 hours a day.",
        "success-title": "Featured Businesses",
        "process-title": "The Path to Autonomy",
        "step1-h": "Market Study",
        "step1-p": "We analyze your niche and competition to find the most aggressive sales angle.",
        "step2-h": "Multimedia Content Creation",
        "step2-p": "We design multimedia content to get customers.",
        "step3-h": "Meta Ads Campaigns",
        "step3-p": "We set up high-precision campaigns to attract qualified traffic from day 1.",
        "step4-h": "Smart Form",
        "step4-p": "Intelligent forms that adapt their questions based on user responses.",
        "step5-h": "AI Filtering Chatbot",
        "step5-p": "The final chatbot qualifies the lead and schedules the meeting directly in your calendar.",
        "integrations-title": "Elite Integrations",
        "pricing-title": "Investment with Return",
        "price-plan-name": "Indomable Plan",
        "price-ads-info": "+ Ad investment separate",
        "feat1": "Full Market Study",
        "feat2": "Persuasive Audiovisual Production",
        "feat3": "Meta Campaign Management",
        "feat4": "Sales Funnel Integration",
        "feat5": "Premium 24/7 Support",
        "price-cta": "Get Started Now",
        "support-badge": "Premium Support Activated",
        "ai-disclosure": "Transparency: System fully operated by AI Agents.",
        "modal-title": "Scale your business today",
        "form-name": "Name",
        "form-company": "Company Name",
        "form-whatsapp": "WhatsApp",
        "form-email": "Gmail / Email",
        "form-service": "Service / Product",
        "form-team": "Do you have a sales team?",
        "form-submit": "Send Request",
        "footer-text": "© 2026 Indomable. All rights reserved.",
        "compare-title": "The end of the manual era",
        "compare-manual-status": "TRADITIONAL METHOD",
        "compare-ai-status": "iNDOMABLE SYSTEM",
        "manual-f1": "Sleeps 8 hours a day.",
        "manual-f2": "Loses 80% of leads due to delay.",
        "manual-f3": "Has bad days, stress, and fatigue.",
        "manual-f4": "Costs thousands in payroll and insurance.",
        "ai-f1": "Sells 24/7 without rest.",
        "ai-f2": "Response in < 10 seconds.",
        "ai-f3": "Perfect consistency in every chat.",
        "ai-f4": "Fraction of the cost of a salary.",
        "stat-leads": "Leads Filtered today",
        "stat-meetings": "Meetings Booked",
        "stat-uptime": "Commercial Uptime",
        "faq-title": "Frequently Asked Questions",
        "faq-q1": "Is AI safe for my brand?",
        "faq-a1": "Absolutely. We set ethical guardrails and brand tone so the AI never says anything out of place.",
        "faq-q2": "How long to see results?",
        "faq-a2": "From day one. Once we launch campaigns and activate the agent, you will start receiving qualified leads immediately.",
        "faq-q3": "Do I need to know coding?",
        "faq-a3": "No. We handle all technical configuration and integration. You just receive meetings in your calendar.",
    }
};

let currentLang = 'es';

const switchLanguage = () => {
    currentLang = currentLang === 'es' ? 'en' : 'es';
    const elements = document.querySelectorAll('[data-i18n]');
    elements.forEach(el => {
        const key = el.getAttribute('data-i18n');
        el.innerHTML = i18n[currentLang][key];
    });
};

// Sticky Header Logic
let lastScroll = 0;
window.addEventListener('scroll', () => {
    const header = document.querySelector('.sticky-header');
    const currentScroll = window.pageYOffset;
    if (currentScroll > 100) {
        header.classList.add('header-scrolled');
    } else {
        header.classList.remove('header-scrolled');
    }

    if (currentScroll > lastScroll && currentScroll > 500) {
        header.classList.add('header-hidden');
    } else {
        header.classList.remove('header-hidden');
    }
    lastScroll = currentScroll;
});

document.addEventListener('DOMContentLoaded', () => {
    // Theme Switcher
    const themeBtn = document.getElementById('theme-toggle');
    themeBtn.addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
    });

    // Check saved theme
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
        document.documentElement.setAttribute('data-theme', savedTheme);
    }

    // Language Switcher
    document.getElementById('lang-switch').addEventListener('click', switchLanguage);

    // Modal Logic
    const modal = document.getElementById('lead-modal');
    const openBtns = document.querySelectorAll('.open-form');
    const closeBtn = document.querySelector('.close-modal');

    openBtns.forEach(btn => {
        btn.onclick = () => modal.style.display = 'block';
    });

    closeBtn.onclick = () => modal.style.display = 'none';

    window.onclick = (event) => {
        if (event.target == modal) modal.style.display = 'none';
    };

    // FAQ Accordion
    const faqItems = document.querySelectorAll('.faq-item');
    faqItems.forEach(item => {
        const question = item.querySelector('.faq-question');
        question.onclick = () => {
            const isActive = item.classList.contains('active');
            faqItems.forEach(i => i.classList.remove('active'));
            if (!isActive) item.classList.add('active');
        };
    });

    // Form Submission
    const leadForm = document.getElementById('lead-form');
    leadForm.onsubmit = async (e) => {
        e.preventDefault();

        const submitBtn = leadForm.querySelector('button[type="submit"]');
        const originalBtnText = submitBtn.innerHTML;
        submitBtn.disabled = true;
        submitBtn.innerHTML = currentLang === 'es' ? 'Enviando...' : 'Sending...';

        const formData = {
            name: document.getElementById('name').value,
            company: document.getElementById('company').value,
            whatsapp: document.getElementById('country-prefix').value + ' ' + document.getElementById('whatsapp').value,
            email: document.getElementById('email').value,
            service: document.getElementById('service').value,
            salesTeam: document.getElementById('sales-team').checked,
            timestamp: new Date().toISOString(),
            page: window.location.href
        };

        try {
            const response = await fetch('https://hook.eu2.make.com/xx4a8n1hm7a84w69w2selmt96ng26m6x', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData),
            });

            if (response.ok) {
                alert(currentLang === 'es' ? '¡Solicitud enviada con éxito! Te contactaremos por WhatsApp.' : 'Request sent successfully! We will contact you via WhatsApp.');
                leadForm.reset();
                modal.style.display = 'none';
            } else {
                throw new Error('Server responded with an error');
            }
        } catch (error) {
            console.error('Submission error:', error);
            alert(currentLang === 'es' ? 'Hubo un error al enviar. Por favor, inténtalo de nuevo.' : 'There was an error sending. Please try again.');
        } finally {
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalBtnText;
        }
    };

    // Smooth scrolling for navigation
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({ behavior: 'smooth' });
            }
        });
    });

    // Energy Ball Logic (Hero Section Only)
    const energyBall = document.getElementById('energy-ball');
    const heroSection = document.querySelector('.hero-section');
    if (energyBall && heroSection) {
        heroSection.onmousemove = (e) => {
            energyBall.style.opacity = '1';
            energyBall.style.left = `${e.clientX - 100}px`;
            energyBall.style.top = `${e.clientY - 100}px`;
        };
        heroSection.onmouseleave = () => {
            energyBall.style.opacity = '0';
        };
    }

    // Pricing Card Mouse Follow
    const pricingCard = document.querySelector('.pricing-card.premium');
    if (pricingCard) {
        pricingCard.onmousemove = (e) => {
            const rect = pricingCard.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            pricingCard.style.setProperty('--x', `${x}px`);
            pricingCard.style.setProperty('--y', `${y}px`);
        };
    }

    // Enhanced Reveal Animation
    const reveal = () => {
        const reveals = document.querySelectorAll('.glass-card, .timeline-step, .pricing-card, .success-item, .comparison-card, .faq-item');
        reveals.forEach((el, index) => {
            const windowHeight = window.innerHeight;
            const elementTop = el.getBoundingClientRect().top;
            const elementVisible = 100;
            if (elementTop < windowHeight - elementVisible) {
                // Staggered delay based on index if multiple in same row
                const delay = (el.offsetLeft > 0) ? (index % 3) * 0.1 : 0;
                el.style.transitionDelay = `${delay}s`;
                el.style.opacity = '1';
                el.style.transform = 'translateY(0) scale(1)';
            }
        });
    };

    // Set initial state for animations
    const animatedElements = document.querySelectorAll('.glass-card, .timeline-step, .pricing-card, .success-item, .comparison-card, .faq-item');
    animatedElements.forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(40px) scale(0.98)';
        el.style.transition = 'all 0.8s cubic-bezier(0.16, 1, 0.3, 1)';
    });

    // Stats Counter Animation
    const animateValue = (id, start, end, duration) => {
        const obj = document.getElementById(id);
        if (!obj) return;
        let startTimestamp = null;
        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            obj.innerHTML = Math.floor(progress * (end - start) + start);
            if (progress < 1) {
                window.requestAnimationFrame(step);
            }
        };
        window.requestAnimationFrame(step);
    };

    const statsRevealed = new Set();
    const revealStats = () => {
        const statsEl = document.querySelector('.stats-section');
        if (!statsEl) return;
        const rect = statsEl.getBoundingClientRect();
        if (rect.top < window.innerHeight && !statsRevealed.has('done')) {
            animateValue("val-leads", 0, 1420, 2000);
            animateValue("val-meetings", 0, 84, 2000);
            animateValue("val-uptime", 0, 100, 2000);
            statsRevealed.add('done');
        }
    };

    window.addEventListener('scroll', () => {
        reveal();
        revealStats();
    });
    reveal();
    revealStats();
});

